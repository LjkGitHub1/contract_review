# 审核重点配置功能说明

## 功能概述

审核重点配置功能允许系统管理员为不同层级的审核员配置各自的审核着重点，确保每个层级的审核员在审核合同时能够关注到相应的重点内容。

## 功能特点

1. **层级化管理**：支持一级、二级、三级（高级）三个审核层级
2. **灵活配置**：每个层级可以独立配置审核重点、关注事项和审核标准
3. **JSON格式存储**：审核重点和关注事项使用JSON格式存储，支持多个项目
4. **启用/禁用控制**：可以启用或禁用某个层级的配置

## 数据模型

### ReviewFocusConfig（审核重点配置表）

**字段说明：**

| 字段名 | 类型 | 说明 |
|--------|------|------|
| level | CharField | 审核层级（level1/level2/level3） |
| level_name | CharField | 层级名称 |
| focus_points | JSONField | 审核重点列表（JSON数组） |
| focus_description | TextField | 审核重点描述 |
| review_standards | TextField | 审核标准 |
| attention_items | JSONField | 关注事项列表（JSON数组，可选） |
| is_active | BooleanField | 是否启用 |
| created_by | ForeignKey | 创建人 |
| updated_by | ForeignKey | 更新人 |
| created_at | DateTimeField | 创建时间 |
| updated_at | DateTimeField | 更新时间 |

## API接口

### 1. 获取配置列表
```
GET /api/reviews/focus-configs/
```

**响应示例：**
```json
{
  "count": 3,
  "results": [
    {
      "id": 1,
      "level": "level1",
      "level_name": "一级审核员",
      "focus_points": ["格式规范", "基础条款完整性", "基本信息准确性"],
      "focus_description": "一级审核员重点关注合同格式、基础条款和基本信息",
      "review_standards": "符合合同格式要求，基础信息准确完整",
      "attention_items": ["合同格式", "条款编号", "基本信息", "基础条款"],
      "is_active": true,
      "created_by_name": "admin",
      "updated_by_name": "admin",
      "created_at": "2024-12-22T10:00:00Z",
      "updated_at": "2024-12-22T10:00:00Z"
    }
  ]
}
```

### 2. 获取单个配置
```
GET /api/reviews/focus-configs/{id}/
```

### 3. 创建配置
```
POST /api/reviews/focus-configs/
Content-Type: application/json

{
  "level": "level1",
  "level_name": "一级审核员",
  "focus_points": ["格式规范", "基础条款完整性"],
  "focus_description": "一级审核员重点关注...",
  "review_standards": "审核标准...",
  "attention_items": ["合同格式", "条款编号"],
  "is_active": true
}
```

### 4. 更新配置
```
PATCH /api/reviews/focus-configs/{id}/
Content-Type: application/json

{
  "focus_points": ["格式规范", "基础条款完整性", "新增重点"],
  "focus_description": "更新后的描述"
}
```

### 5. 删除配置
```
DELETE /api/reviews/focus-configs/{id}/
```

### 6. 根据层级获取配置
```
GET /api/reviews/focus-configs/by_level/?level=level1
```

## 前端页面

### 页面路径
`/review-focus-config`

### 功能特性

1. **配置列表展示**
   - 显示所有层级的配置
   - 显示层级名称、审核重点描述、状态等信息
   - 支持编辑和删除操作

2. **创建/编辑配置**
   - 选择审核层级（一级/二级/三级）
   - 输入层级名称
   - 输入审核重点（每行一个，自动转换为列表）
   - 输入审核重点描述
   - 输入审核标准
   - 输入关注事项（每行一个，自动转换为列表）
   - 设置是否启用

3. **数据验证**
   - 层级必填且唯一
   - 层级名称必填
   - 审核重点至少一个
   - 审核重点描述必填

## 使用场景

### 场景1：初始化配置

系统管理员首次使用时，为三个层级分别创建配置：

**一级审核员配置：**
- 审核重点：格式规范、基础条款完整性、基本信息准确性
- 关注内容：合同格式、条款编号、基本信息、基础条款是否完整

**二级审核员配置：**
- 审核重点：法律合规性、风险识别、条款合理性、权利义务平衡
- 关注内容：合同条款是否符合法律法规、是否存在法律风险、条款是否合理、双方权利义务是否平衡

**三级审核员配置：**
- 审核重点：重大风险、战略层面、商业决策、最终批准
- 关注内容：重大风险点、战略影响、商业价值、最终决策

### 场景2：更新配置

根据实际使用情况，管理员可以随时更新某个层级的审核重点配置，以适应业务需求的变化。

### 场景3：启用/禁用配置

如果某个层级的配置暂时不需要使用，可以将其禁用，而不是删除，方便后续重新启用。

## 数据库迁移

运行以下命令创建数据库迁移：

```bash
cd backend
python manage.py makemigrations reviews
python manage.py migrate
```

## 默认配置示例

### 一级审核员（level1）

```json
{
  "level": "level1",
  "level_name": "一级审核员",
  "focus_points": [
    "格式规范",
    "基础条款完整性",
    "基本信息准确性"
  ],
  "focus_description": "一级审核员重点关注合同格式、基础条款和基本信息。确保合同格式符合要求，基础信息准确完整，基础条款齐全。",
  "review_standards": "符合合同格式要求，基础信息准确完整，基础条款齐全",
  "attention_items": [
    "合同格式是否符合要求",
    "条款编号是否正确",
    "基本信息是否准确",
    "基础条款是否完整"
  ]
}
```

### 二级审核员（level2）

```json
{
  "level": "level2",
  "level_name": "二级审核员",
  "focus_points": [
    "法律合规性",
    "风险识别",
    "条款合理性",
    "权利义务平衡"
  ],
  "focus_description": "二级审核员重点关注法律合规性、风险识别、条款合理性和权利义务平衡。确保合同条款符合法律法规，识别潜在风险，评估条款合理性。",
  "review_standards": "法律合规性、风险等级评估、条款合理性分析",
  "attention_items": [
    "合同条款是否符合法律法规",
    "是否存在法律风险",
    "条款是否合理",
    "双方权利义务是否平衡"
  ]
}
```

### 三级审核员（level3）

```json
{
  "level": "level3",
  "level_name": "三级审核员（高级）",
  "focus_points": [
    "重大风险",
    "战略层面",
    "商业决策",
    "最终批准"
  ],
  "focus_description": "三级审核员（高级）重点关注重大风险、战略层面、商业决策和最终批准。评估重大风险是否可控，是否符合企业战略，做出最终决策。",
  "review_standards": "重大风险是否可控，是否符合企业战略，是否批准签署",
  "attention_items": [
    "重大风险点是否可控",
    "是否符合企业战略",
    "商业价值评估",
    "最终决策"
  ]
}
```

## 权限控制

- **查看权限**：所有已登录用户都可以查看配置列表
- **创建/编辑/删除权限**：建议仅管理员或审核管理员可以操作
- 可以通过Django的权限系统进一步细化权限控制

## 后续扩展建议

1. **配置模板**：提供配置模板，方便快速创建
2. **配置历史**：记录配置变更历史，支持版本回退
3. **配置导入导出**：支持批量导入导出配置
4. **配置验证**：在审核任务创建时，根据审核员层级自动应用对应的审核重点配置
5. **审核提示**：在审核界面显示当前层级的审核重点，提醒审核员关注

## 注意事项

1. 每个层级只能有一个启用的配置（通过level字段的唯一性约束保证）
2. 删除配置前请确认没有正在使用该配置的审核任务
3. 审核重点和关注事项建议使用简洁明了的描述
4. 配置更新后，新的审核任务将使用新配置，已存在的审核任务不受影响

---

**创建时间**：2024年12月22日  
**功能状态**：已实现

