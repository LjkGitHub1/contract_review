# 测试数据填充说明

## 功能说明

本命令用于为AI智能合同审核系统填充测试数据，包括：

- 部门数据（层级结构）
- 用户数据（管理员、审核员、起草人）
- 合同模板
- 合同数据（不同状态和类型）
- 合同版本
- 合同条款
- 审核规则
- 审核任务和审核结果
- 审核意见
- 风险识别记录
- 对比任务和差异
- 知识实体和关系
- 法律法规和案例
- 推荐记录
- 用户习惯
- 审计日志

## 使用方法

### 基本使用

```bash
# 进入后端目录
cd backend

# 填充测试数据（保留现有数据）
python manage.py fill_test_data

# 清空现有数据后再填充
python manage.py fill_test_data --clear
```

### 注意事项

1. **首次使用建议使用 `--clear` 参数**，确保数据干净
2. 如果数据库中已有重要数据，请先备份
3. 填充的数据量较大，可能需要几分钟时间
4. 确保数据库连接正常，且已执行过数据库迁移

## 填充的数据量

- 部门：6个（包含层级结构）
- 用户：8个（1个管理员，2个审核员，5个起草人）
- 模板：4个
- 合同：18个（不同状态）
- 合同版本：约15个
- 条款：约60-160个
- 规则：5个
- 审核任务：15个
- 审核结果：约10个
- 审核意见：约20-60个
- 风险识别：约10-50个
- 对比任务：5个
- 知识实体：6个
- 推荐记录：约10-25个
- 审计日志：约40-120个

## 测试账号

填充完成后，可以使用以下测试账号登录：

- **管理员**
  - 用户名：`admin`
  - 密码：`admin123`

- **审核员**
  - 用户名：`reviewer1` / `reviewer2`
  - 密码：`reviewer123`

- **起草人**
  - 用户名：`drafter1` / `drafter2` / `drafter3` / `drafter4` / `drafter5`
  - 密码：`drafter123`

## 数据特点

1. **关联性完整**：所有数据都有正确的关联关系
2. **状态多样**：合同、审核任务等包含各种状态
3. **时间分布**：数据时间分布在最近30天内
4. **真实感强**：数据内容贴近实际业务场景

## 常见问题

### Q: 命令执行失败？
A: 检查以下几点：
- Django环境是否正确配置
- 数据库连接是否正常
- 是否已执行数据库迁移（`python manage.py migrate`）

### Q: 数据填充不完整？
A: 可能是数据库约束问题，检查：
- 外键关联是否正确
- 必填字段是否都有值
- 唯一约束是否冲突

### Q: 如何清空所有测试数据？
A: 使用 `--clear` 参数，或者手动删除相关数据表

## 开发建议

如果需要修改测试数据：
1. 编辑 `apps/users/management/commands/fill_test_data.py`
2. 修改对应的创建方法
3. 重新运行命令（建议使用 `--clear`）



